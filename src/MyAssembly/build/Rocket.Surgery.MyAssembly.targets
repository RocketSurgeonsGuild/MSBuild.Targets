<Project>

  <ItemGroup>
    <Compile Include="$(MSBuildThisFileDirectory)**/*$(DefaultLanguageSourceExtension)"
      Source="Shared" />
    <EmbeddedResource Include="$(MSBuildThisFileDirectory)**/*.resx" Source="Shared" />
    <None Include="$(MSBuildThisFileDirectory)**/*"
      Exclude="$(MSBuildThisFileDirectory)*.projitems;$(MSBuildThisFileDirectory)*.shproj"
      Source="Shared" />
    <None Remove="$(MSBuildThisFileDirectory)**/*$(DefaultLanguageSourceExtension)" />
    <None Remove="$(MSBuildThisFileDirectory)**/*.resx" />
  </ItemGroup>

  <ItemGroup>
    <Compile Update="@(Compile -&gt; WithMetadataValue('Source', 'Shared'))">
      <Link>%(RecursiveDir)%(Filename)%(Extension)</Link>
    </Compile>
    <EmbeddedResource Update="@(EmbeddedResource -&gt; WithMetadataValue('Source', 'Shared'))">
      <Link>%(RecursiveDir)%(Filename)%(Extension)</Link>
    </EmbeddedResource>
    <None Update="@(None -&gt; WithMetadataValue('Source', 'Shared'))">
      <Link>%(RecursiveDir)%(Filename)%(Extension)</Link>
    </None>
  </ItemGroup>

  <Import Project="$(MSBuildThisFileDirectory)MyAssembly.targets" />
  <Import Project="$(MSBuildThisFileDirectory)MyAssembly.Constants.targets" />
  <Import Project="$(MSBuildThisFileDirectory)MyAssembly.Metadata.targets" />
  <Import Project="$(MSBuildThisFileDirectory)MyAssembly.Project.targets" />
  <Import Project="$(MSBuildThisFileDirectory)MyAssembly.Resources.targets" />


</Project>